version: '3.8'

services:
  ejabberd:
    image: ejabberd/ecs:latest
    container_name: xmpp-server
    ports:
      - "5222:5222"   # XMPP C2S
      - "5269:5269"   # XMPP S2S
      - "5443:5443"   # HTTPS
      - "5280:5280"   # HTTP
    volumes:
      - ./ejabberd.yml:/home/ejabberd/conf/ejabberd.yml:ro
      - ejabberd_data:/home/ejabberd/database
    environment:
      - EJABBERD_ADMIN_USER=admin
      - EJABBERD_ADMIN_PASSWORD=admin123
    networks:
      - xmpp-net
    restart: unless-stopped

volumes:
  ejabberd_data:

networks:
  xmpp-net:
    driver: bridge